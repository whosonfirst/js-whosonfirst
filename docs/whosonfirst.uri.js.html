<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: whosonfirst.uri.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: whosonfirst.uri.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @namespace whosonfirst.uri
 * @description Methods for deriving URIs from Who's On First identifiers.   
 */

var whosonfirst = whosonfirst || {};

whosonfirst.uri = (function(){
	
    var _endpoint = "https://data.whosonfirst.org/";
	
    var self = {

	/**
	 * @typedef {Object} uriArgs
	 * @memberof whosonfirst.uri	   	   
	 * @property {boolean} [alt] - Flags that this is an "alternate" geometry URI.
	 * @property {string} [source] - The source component of an "alternate" geometry URI.
	 * @property {string} [function] - The function component of an "alternate" geometry URI.
	 * @property {string[]} [extras] - Any additional, use-specific, components of an "alternate" geometry URI.	   	   
	 */

	/**
	 * @function endpoint
	 * @memberof whosonfirst.uri
	 * @description Returns the currently assigned endpoint URI. Default is https://data.whosonfirst.org.
	 * @param {string} [e] - A new endpoint URI to assign.
	 * @returns {string} Returns the currently assigned endpoint URI.
	 */		    		
	endpoint: function(e){

	    if (e){
		console.log("set uri endpoint to " + e);
		_endpoint = e;
	    }
	    
	    return _endpoint;
	},

	/**
	 * @function idToAbsPath
	 * @memberof whosonfirst.uri
	 * @description Derive the absolute URI for a Who's On First ID.
	 * @param {number} id - A valid Who's On First ID.
	 * @param {uriArgs} [args] - Any additional arguments for deriving the final URI.
	 * @returns {string} The absolute URI for a Who's On First ID.
	 */		    			
	idToAbsPath: function(id, args){
	    
	    var rel_path = self.idToRelPath(id, args);
	    var abs_path = self.endpoint() + rel_path;
	    
	    return abs_path;
	},

	/**
	 * @function idToRelPath
	 * @memberof whosonfirst.uri
	 * @description Derive the relvative URI for a Who's On First ID.
	 * @param {number} id - A valid	Who's On First ID.
	 * @param {uriArgs} [args] - Any additional arguments for deriving the final URI.
	 * @returns {string} The absolute URI for a Who's On First ID.
	 */		    				
	idToRelPath: function(id, args){
	    
	    parent = self.idToRoot(id);
	    fname = self.idToFilename(id, args);
	    
	    var rel_path = parent + "/" + fname;
	    return rel_path;
	},

	/**
	 * @function idToRoot
	 * @memberof whosonfirst.uri
	 * @description Derive the tree "root" for a Who's On First ID.
	 * @param {number} id - A valid Who's On First ID.
	 * @returns {string} The tree "root" for a Who's On First ID.
	 */		    				
	idToRoot: function(id){
	    
	    str_id = new String(id);
	    tmp = new Array();
	    
	    while (str_id.length){
		
		var part = str_id.substr(0, 3);
		tmp.push(part);
		str_id = str_id.substr(3);
	    }
	    
	    parent = tmp.join("/");
	    return parent;
	},

	/**
	 * @function idToFilename
	 * @memberof whosonfirst.uri
	 * @description - Derive the filename for a Who's On First ID.
	 * @param {number} id - A valid Who's On First ID.
	 * @param {uriArgs} [args] - Any additional arguments for deriving the filename.
	 * @returns {string} The filename for a Who's On First ID.
	 */		    				
	idToFilename: function(id, args){
	    
	    if (! args){
		args = {};
	    }
	    
	    var fname = [
		encodeURIComponent(id)
	    ];
	    
	    if (args["alt"]) {
		fname.push('alt');
		
		if (args["source"]){
		    
		    // to do: validate source here
		    // to do: actually write whosonfirst.source.js
		    // (20161130/thisisaaronland)
		    
		    var source = encodeURIComponent(args["source"]);
		    fname.push(source);
		    
		    if (args["function"]){
			
			var func = encodeURIComponent(args["function"]);
			fname.push(func);
			
			if ((args["extras"]) &amp;&amp; (args["extras"].join)){
			    
			    var extras = args["extras"];
			    var count = extras.length;
			    
			    for (var i = 0; i &lt; count; i++){
				var extra = encodeURIComponent(extras[i]);
				fname.push(extra);
			    }
			}
		    }
		}
		
		else {
		    console.warn("missing source parameter for alternate geometry");
		    fname.push("unknown");
		}
		
	    }
	    
	    var str_fname = fname.join("-");
	    return str_fname + ".geojson";
	},

	id2abspath: function (id, args){
	    console.warn("id2abspath is deprecated, please use idToAbsPath");
	    return self.idToAbsPath(id, args);
	},

	id2relpath: function (id, args){
	    console.warn("id2relpath is deprecated, please use idToRelPath");	    
	    return self.idToRelPath(id, args);
	},

	id2parent: function(id){
	    console.warn("id2parent is deprecated, please use idToRoot");	    	    
	    return self.idToParent(id);
	},

	id2fname: function(id, args){
	    console.warn("id2fname is deprecated, please use idToFilename");	    	    	    
	    return self.idToFilename(id, args);
	},
	
    };
    
    return self;
    
})();
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="whosonfirst.html">whosonfirst</a></li><li><a href="whosonfirst.data.html">data</a></li><li><a href="whosonfirst.flags.html">flags</a></li><li><a href="whosonfirst.flags.existential.html">existential</a></li><li><a href="whosonfirst.geojson.html">geojson</a></li><li><a href="whosonfirst.namify.html">namify</a></li><li><a href="whosonfirst.placetypes.html">placetypes</a></li><li><a href="whosonfirst.uri.html">uri</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Fri Aug 22 2025 15:44:45 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
